<!DOCTYPE HTML>
<html lang="en" class="dark" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TLCS - C++ - TimeLock Cryptographic Service</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="njmstyle.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('dark')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="ch01-01.html"><strong aria-hidden="true">1.</strong> Timelock Cryptographic Service</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch01-02.html"><strong aria-hidden="true">1.1.</strong> How It Works?</a></li><li class="chapter-item expanded "><a href="ch01-03.html"><strong aria-hidden="true">1.2.</strong> Security</a></li><li class="chapter-item expanded "><a href="ch01-04.html"><strong aria-hidden="true">1.3.</strong> Alpha Service Demo</a></li></ol></li><li class="chapter-item expanded "><a href="ch02-01.html"><strong aria-hidden="true">2.</strong> Formal Description</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch02-02.html"><strong aria-hidden="true">2.1.</strong> TLCS from NIZK</a></li><li class="chapter-item expanded "><a href="ch02-03.html"><strong aria-hidden="true">2.2.</strong> Efficient TLCS</a></li><li class="chapter-item expanded "><a href="ch02-04.html"><strong aria-hidden="true">2.3.</strong> Correctness</a></li><li class="chapter-item expanded "><a href="ch02-05.html"><strong aria-hidden="true">2.4.</strong> Security Model</a></li><li class="chapter-item expanded "><a href="ch02-06.html"><strong aria-hidden="true">2.5.</strong> TLCS curves</a></li></ol></li><li class="chapter-item expanded "><a href="ch03-01.html"><strong aria-hidden="true">3.</strong> Implementation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-02.html" class="active"><strong aria-hidden="true">3.1.</strong> TLCS - C++</a></li><li class="chapter-item expanded "><a href="ch03-03.html"><strong aria-hidden="true">3.2.</strong> TLCS - Rust</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-01.html"><strong aria-hidden="true">4.</strong> Application and Use Cases</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-02.html"><strong aria-hidden="true">4.1.</strong> Noun Project</a></li><li class="chapter-item expanded "><a href="ch04-03.html"><strong aria-hidden="true">4.2.</strong> Timelock Encryption</a></li><li class="chapter-item expanded "><a href="ch04-04.html"><strong aria-hidden="true">4.3.</strong> Commitment</a></li><li class="chapter-item expanded "><a href="ch04-05.html"><strong aria-hidden="true">4.4.</strong> Expiring ZK Proofs</a></li><li class="chapter-item expanded "><a href="ch04-06.html"><strong aria-hidden="true">4.5.</strong> E-voting</a></li><li class="chapter-item expanded "><a href="ch04-07.html"><strong aria-hidden="true">4.6.</strong> TLCS fs</a></li><li class="chapter-item expanded "><a href="ch04-08.html"><strong aria-hidden="true">4.7.</strong> Trustless betting and auctions</a></li><li class="chapter-item expanded "><a href="ch04-09.html"><strong aria-hidden="true">4.8.</strong> Escrow services</a></li><li class="chapter-item expanded "><a href="ch04-10.html"><strong aria-hidden="true">4.9.</strong> Legal and compliance purposes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">TimeLock Cryptographic Service</h1>

                    <div class="right-buttons">

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="tlcs---c"><a class="header" href="#tlcs---c">TLCS - C++</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The repository provides implementation of the efficient TLCS protocol described in this <a href="https://hackmd.io/WYp7A-jPQvK8xSB1pyH7hQ">note</a> that builds on the LOE (a.k.a. <a href="https://github.com/drand/drand">drand</a> ) service. The implementation is based on the <a href="https://github.com/herumi/mcl/">mcl</a> library and openssl.</p>
<p>The TLCS library allows to create public keys for virtually any elliptic curve supported by openssl and in addition the <code>G1</code> group of the <code>BLS12_381</code> curve and the babyjubjub curve.
To use the <code>G1</code> group set <code>-D_CYC_GRP_BLS_G1=1</code>  in the <code>Makefile</code> before installation or use the corresponding library. Observe that in this case you should be sure that cryptosystem is secure in that group. To use RSA set <code>-D_CYC_GRP_RSA=1</code> or use the corresponding library. </p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<pre><code class="language-bash">git clone https://github.com/herumi/mcl.git
cd mcl
make all
cd ..
chmod u+x install.sh
./install.sh
</code></pre>
<h2 id="apis"><a class="header" href="#apis">APIs</a></h2>
<p>The APIs can be divided in routines for:</p>
<ul>
<li>the prover contained in the file <code>src/prover.c</code></li>
<li>for the verifier in <code>src/verifier.c</code></li>
<li>for inversion of the public key in <code>src/invert.c</code></li>
<li>aggregation of the participants' public keys in <code>src/aggregate.c</code> </li>
</ul>
<p>The prover, verifier and inversion have corresponding versions for the secret sharing variant.</p>
<h2 id="news"><a class="header" href="#news">News</a></h2>
<ul>
<li>20-May-2023 Added experimental support for the secret sharing variant.</li>
<li>16-May-2023 Added experimental support for babyjubjub ec.</li>
<li>14-May-2023 Added support for RSA.</li>
<li>07-May-2023 Launch!</li>
</ul>
<h2 id="demo"><a class="header" href="#demo">Demo</a></h2>
<p>The source code contains a file * <code>examples/tlcs.c</code> implementing a demo simulation of a TLCS activity using the routines in the library. 
The demo is supposed to simulate locally a TLCS protocol consisting of proving, verification, aggregation and inversion phases. </p>
<h3 id="example-of-usage-of-the-demo"><a class="header" href="#example-of-usage-of-the-demo">Example of usage of the demo</a></h3>
<pre><code class="language-bash">./bin/demo_prover proof
</code></pre>
<p>The previous command will simulate a party that creates his public key and proof and writes it to the file named <code>proof</code>.
The demo will ask you for which type of curve you want to generate your public key and for a round number <code>T</code> of LOE with respect to which you want that the protocol is executed. 
The file is intented to simulate a blockchain activity so if you will re-execute the same command with same file, you will simulate another party who wrote to the blockchain.
Let us suppose we executed the command twice and in each execution we used the same file <code>proof</code>, the same curve number (e.g., <code>714</code>) and we selected the same input <code>T</code>.</p>
<p>Now, the file <code>proof</code> contains the public keys and the proofs of two parties. </p>
<pre><code class="language-bash">./bin/demo_verifier proof verificationresult
</code></pre>
<p>The previous command simulates a verifier that reads the fil <code>proof</code> and writes an array of 0/1 results in the file <code>verificationresult</code>. The i-th element of the array is <code>1</code> if the proof of the i-th party is verifid successfully and <code>0</code> otherwise.
So, in our example after the execution of the last command, the fil <code>verificationresult</code> will contain the string <code>1 1</code> to indicate that both proofs of the two parties were successfully verified.</p>
<pre><code class="language-bash">./bin/demo_aggregator proof aggregated_pk 1 1
</code></pre>
<p>The previous commands simulates the aggregation phase of the protocol. The aggregator reads the file <code>proof</code> that in our example contains the output of two parties and uses the list <code>1 1</code> to know which party computed valid proof (in our example both parties computed valid proofs so the list is <code>1 1</code>) and outputs the aggregated public key in the file <code>aggregated_pk</code>.</p>
<p>At time corresponding to round number <code>T</code>, LOE publishes a signature for the round <code>T</code> (the link where to get this signature was printed out after executing <code>demo_prover</code>).</p>
<pre><code class="language-bash">./bin/demo_invert proof aggregated_pk 1 1
</code></pre>
<p>The previous command simulates the inversion phase in which after time corresponding to round <code>T</code> we aim at inverting the aggregated public key contained in the file <code>aggregated_pk</code>. To this purpose we pass as input to the latter program the file <code>proof</code> that contains the public keys of all parties who participated in the protocol and their respective proofs, the aggregate public key file <code>aggregated_pk</code> and, in our example, the list of 0/1 values <code>1 1</code> to indicate that the file <code>proof</code> contains two proofs that are both accepted.
The program will ask for you for the signature of LOE of round <code>T</code> and should print out the secret key corresponding to the aggregated public key in the file <code>aggregated_pk</code>.</p>
<h2 id="how-to-use-our-tlcs-system"><a class="header" href="#how-to-use-our-tlcs-system">How to use our TLCS system</a></h2>
<p>See our <a href="https://github.com/aragonzkresearch/tlcs-c/blob/main/examples/howtoencrypt.md">How to Use</a> page for examples on how to use our system to encrypt.</p>
<h2 id="contacts"><a class="header" href="#contacts">Contacts</a></h2>
<p>Vincenzo Iovino (vincenzo@aragon.org)</p>
<p>Aragon ZK Research Team: https://research.aragon.org/</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<p>Vincenzo Iovino. <a href="https://hackmd.io/WYp7A-jPQvK8xSB1pyH7hQ">How to Build a Time Lock Crypto Service based on League of Entropy</a>, May 2023.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch03-01.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch03-03.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch03-01.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch03-03.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
